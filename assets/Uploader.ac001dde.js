import{d as m,k as u,l as h,m as U,_ as v,n as b,a as y,b as F,f as s,p as d,q as k,s as C}from"./index.6f9a7cbe.js";const $=m({name:"Uploader",props:{action:{type:String,required:!0},beforeUpload:{type:Function},editUp:{type:String}},inheritAttrs:!1,emits:["file-uploaded"],setup(e,a){const t=u(null);h();const l=u(e.editUp?"success":"ready"),o=u(e.editUp?e.editUp:"");return U(()=>e.editUp,i=>{i&&(o.value=i,l.value="success")}),{triggerUpload:()=>{t.value&&t.value.click()},fileInputRef:t,fileStatus:l,handleFileChange:i=>{const f=i.target;if(f.files){const p=Array.from(f.files);if(e.beforeUpload&&!e.beforeUpload(p[0]))return;l.value="loading";const c=new FormData;c.append("file",p[0]),b.post(e.action,c,{headers:{"Content-Type":"multipart/form-data"}}).then(n=>{console.log(n.data.data.url),o.value=n.data.data.url,l.value="success",a.emit("file-uploaded",n.data.data)}).catch(n=>{l.value="error"}).finally(()=>{t.value&&(t.value.value="")})}},uploadedData:o}}}),B=s("button",{class:"btn btn-primart"},"\u6B63\u5728\u4E0A\u4F20",-1),S=s("button",{class:"btn btn-primary"},"\u4E0A\u4F20\u6210\u529F",-1),A=s("button",{class:"btn btn-primary"},"\u70B9\u51FB\u4E0A\u4F20",-1);function D(e,a,t,l,o,g){return y(),F("div",null,[s("div",k({onClick:a[0]||(a[0]=C((...r)=>e.triggerUpload&&e.triggerUpload(...r),["prevent"]))},e.$attrs),[e.fileStatus==="loading"?d(e.$slots,"loading",{key:0},()=>[B]):e.fileStatus==="success"?d(e.$slots,"uploaded",{key:1,uploadedData:e.uploadedData},()=>[S]):d(e.$slots,"default",{key:2},()=>[A])],16),s("input",{type:"file",class:"d-none",ref:"fileInputRef",onChange:a[1]||(a[1]=(...r)=>e.handleFileChange&&e.handleFileChange(...r))},null,544)])}const R=v($,[["render",D]]);export{R as U};
