import{d as b,u as g,k as P,j as C,_ as $,a,b as l,f as t,t as m,r as h,g as v,w as k,i,E,s as M,M as F,l as w,v as N,c as d,h as A,x as B}from"./index.6f9a7cbe.js";import{m as D}from"./marked.esm.1c7943b9.js";const S=b({props:{user:{type:String,required:!0}},setup(e){let o=e.user;const r=g();let n=P(r.state.user);return C(()=>{r.dispatch("fetchOneUser",o).then(u=>{n.value=u.data.data,console.log(n)})}),{usert:n}}}),T={class:"user-profile-component"},V={class:"d-flex align-items-center"},H=["src","alt"],L={class:"detail ml-2"},U={class:"d-block mb-0"},Y={class:"text-truncate text-muted d-block"};function q(e,o,r,n,u,c){return a(),l("div",T,[t("div",V,[t("img",{src:e.usert.avatar,alt:e.usert.nickName,class:"rounded-circle img-thumbnail"},null,8,H),t("div",L,[t("h6",U,m(e.usert.nickName),1),t("span",Y,m(e.usert.description),1)])])])}const R=$(S,[["render",q]]),j=b({name:"PostDetail",components:{UserProfile:R,Modal:F},setup(){const e=w(),o=g(),r=N(),n=P(!1),u=d(()=>o.state.user),c=e.params.id;C(()=>{o.dispatch("fetchCurrentPost",c)});const s=d(()=>o.getters.getPostById(c)),p=d(()=>{if(s.value&&s.value.content)return s.value.isHTML?s.value.content:D.parse(s.value.content)}),_=d(()=>{if(s.value&&s.value.author)return u.value._id===s.value.author._id});return{currentPost:s,handler:p,user:u,showEditArea:_,deletePost:()=>{n.value=!0},isShow:n,clickNo:()=>{n.value=!1},clickYes:()=>{n.value=!1,o.dispatch("deletePost",c).then(y=>{B("\u5220\u9664\u6210\u529F\uFF0C\u4E24\u79D2\u540E\u8DF3\u8F6C\u5230\u4E13\u680F\u9875\u9762","success"),setTimeout(()=>{r.push({name:"column",params:{id:y.data.column}})},2e3)})}}}}),I={class:"post-detail-page"},O=t("h4",null,"\u786E\u5B9A\u8981\u5220\u9664\u8FD9\u7BC7\u6587\u7AE0\u5417",-1),z={key:0,class:"w-75 mx-auto mb-5 pb-3"},G=["src"],J={class:"mb-4"},K={class:"user-profile-component border-top border-bottom py-3 mb-5 align-items-center row g-0"},Q={class:"col"},W={class:"text-muted col text-right font-italic"},X=["innerHTML"],Z={key:1,class:"btn-group mt-5"};function x(e,o,r,n,u,c){const s=h("modal"),p=h("user-profile"),_=h("router-link");return a(),l("div",I,[v(s,{visible:e.isShow,title:"\u5220\u9664\u6587\u7AE0",onModelClickClose:e.clickNo,onModelClickConfirm:e.clickYes},{default:k(()=>[O]),_:1},8,["visible","onModelClickClose","onModelClickConfirm"]),e.currentPost?(a(),l("article",z,[e.currentPost.image?(a(),l("img",{key:0,src:e.currentPost.image,alt:"currentPost.title",class:"rounded-lg img-fluid my-4"},null,8,G)):i("",!0),t("h2",J,m(e.currentPost.title),1),t("div",K,[t("div",Q,[e.currentPost.author?(a(),E(p,{key:0,user:e.currentPost.author},null,8,["user"])):i("",!0)]),t("span",W,"\u53D1\u8868\u4E8E\uFF1A"+m(e.currentPost.createdAt||"2022:4:24"),1)]),t("div",{innerHTML:e.handler},null,8,X),e.showEditArea?(a(),l("div",Z,[v(_,{to:{name:"createpost",query:{id:e.currentPost._id}},type:"button",class:"btn btn-success"},{default:k(()=>[A(" \u7F16\u8F91 ")]),_:1},8,["to"]),t("button",{type:"button",class:"btn btn-danger",onClick:o[0]||(o[0]=M((...f)=>e.deletePost&&e.deletePost(...f),["prevent"]))},"\u5220\u9664")])):i("",!0)])):i("",!0)])}const ne=$(j,[["render",x]]);export{ne as default};
